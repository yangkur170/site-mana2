<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>{% block title %}Staff{% endblock %}</title>
  {% load static %}

  <style>


@font-face {
  font-family: 'StaffFont';
  src: url("{% static 'fonts/arialnarrow.ttf' %}") format("truetype");
  font-weight: normal;
  font-style: normal;
}

.staff-font {
  font-family: 'StaffFont', Arial, sans-serif !important;
}



/* Apply to ALL staff pages */
body, body * {
  font-family: "Gridova", system-ui, sans-serif !important;
}
/* ===============================
   MODALS
   =============================== */
.logout-modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.62);z-index:9999;padding:18px 14px;box-sizing:border-box}
.logout-modal.show{display:flex}
.logout-box{width:min(420px,92vw);background:rgba(25,25,25,.92);border:1px solid rgba(255,255,255,.14);border-radius:18px;box-shadow:0 24px 60px rgba(0,0,0,.55);backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);padding:16px;color:#fff}
.logout-title{font-weight:950;font-size:16px;margin-bottom:6px}
.logout-text{font-size:13px;opacity:.9;line-height:1.45;margin-bottom:14px}
.logout-actions{display:flex;gap:10px;justify-content:flex-end}
.btn-cancel{height:40px;padding:0 16px;border-radius:999px;border:1px solid rgba(255,255,255,.22);background:rgba(255,255,255,.08);color:#fff;font-weight:900;cursor:pointer}
.btn-confirm{height:40px;padding:0 16px;border-radius:999px;border:0;font-weight:900;cursor:pointer;background:linear-gradient(90deg,#044a72,#969fac);color:#fff}

/* ✅ Message Modal (ONLY ONE in base) */
#msgModal{
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.55);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 9999;
}
#msgModal .modal-box{
  width: min(720px, 94vw);
  background: rgba(248, 248, 248, 0.979);
  border-radius: 18px;
  padding: 16px;
  box-sizing: border-box;
  border: 1px solid rgba(255, 255, 255, 0.747);
  backdrop-filter: blur(18px);
  box-shadow: 0 20px 60px rgba(0,0,0,.45);
}
#msgModal h3{
  margin: 0 0 12px;
  font-family: 'Ovelion', system-ui, sans-serif;
  font-weight: 600;
  letter-spacing: .04em;
}
#msgTextarea{
  width: 100%;
  max-width: 100%;
  min-height: 160px;
  resize: vertical;
  padding: 12px 14px;
  box-sizing: border-box;
  border-radius: 14px;
  border: 1px solid rgba(0,0,0,.25);
  background: rgba(0, 0, 0, 0.856);
  color: #fff;
  font-family: 'Ovelion', system-ui, sans-serif;
  font-size: 14px;
  line-height: 1.5;
  outline: none;
}
#msgTextarea:focus{
  border-color: rgba(0, 0, 0, 0.76);
  box-shadow: 0 0 0 1px rgba(84, 92, 87, 0.61);
}
#msgModal .modal-actions{
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  margin-top: 14px;
}

/* ===============================
   FONT
   =============================== */
.user-font{
  font-family: "Ovelion", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif !important;
  font-weight: 400 !important;
  letter-spacing: .04em;
}
.u-link{ text-decoration:none; font-weight:800; display:inline-block; }

/* ===============================
   ANIMATIONS
   =============================== */
@keyframes slideInRightToLeft {
  from { transform: translateX(70px); opacity: 0; }
  to   { transform: translateX(0);    opacity: 1; }
}
@keyframes slideInLeftToRight {
  from { transform: translateX(-70px); opacity: 0; }
  to   { transform: translateX(0);     opacity: 1; }
}
@keyframes slideInTopToBottom{
  from { transform: translateY(-18px); opacity: 0; }
  to   { transform: translateY(0);     opacity: 1; }
}
.pill.pill-anim-top{ animation: slideInTopToBottom 1200ms ease-out both; will-change: transform, opacity; }
.card.card-anim{ animation: slideInRightToLeft 1200ms ease-out both; }
.card.card-anim-left{ animation: slideInLeftToRight 1200ms ease-out both; }
/* ===== Override Overview Card Background ===== */
.card.card-anim{
  background: linear-gradient(
    145deg,
    rgba(61, 60, 60, 0.226),
    rgba(35, 35, 35, 0.404)
  );

  border: 1px solid rgba(255,255,255,.08);

  box-shadow:
    0 20px 60px rgba(29, 28, 28, 0.568),
    inset 0 1px 0 rgba(255,255,255,.05);

  backdrop-filter: blur(18px);
}

/* ===============================
   THEME
   =============================== */
:root{
  --bg1:#061a10; --bg2:#02130a;
  --card:rgba(213, 233, 218, 0.582);
  --stroke:rgba(255,255,255,.10);
  --txt:rgba(255,255,255,.98);
  --muted:rgba(255,255,255,.84);
  --green:#22c55e;
}

html, body{ height:100%; }
body{
  font-family: 'Ovelion', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  background:
    linear-gradient(rgba(6,26,16,.55), rgba(2,19,10,.75)),
    url("{% static 'img/staff-bg.webp' %}");
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  background-attachment: fixed;
  margin: 0;
  overflow: hidden;
  height: 100vh;
}

.wrap{
  width: calc(100vw - 20px);
  margin: 10px auto;
  padding: 0;
  box-sizing: border-box;
  height: calc(100vh - 20px);
}
/* ===== Animated Lightning Topbar ===== */
.topbar{
  position: relative;
  overflow: hidden;
  border-radius: 18px;
  padding: 10px 14px;
  background: linear-gradient(120deg, #021b2f, #043c63, #021b2f);
  background-size: 300% 300%;
  animation: topbarFlow 8s ease infinite;
}

/* Lightning sweep effect */
.topbar::before{
  content:"";
  position:absolute;
  top:0;
  left:-150%;
  width:60%;
  height:100%;
  background: linear-gradient(
    120deg,
    transparent,
    rgba(0,255,255,.35),
    rgba(0,120,255,.45),
    transparent
  );
  transform: skewX(-25deg);
  animation: lightningMove 4s linear infinite;
}

/* Glow border */
.topbar::after{
  content:"";
  position:absolute;
  inset:0;
  border-radius:18px;
  box-shadow:
    0 0 20px rgba(0,180,255,.35),
    inset 0 0 25px rgba(0,150,255,.25);
  pointer-events:none;
}

/* Background flow */
@keyframes topbarFlow{
  0%{ background-position: 0% 50%; }
  50%{ background-position: 100% 50%; }
  100%{ background-position: 0% 50%; }
}

/* Lightning animation */
@keyframes lightningMove{
  0%{ left:-150%; }
  100%{ left:150%; }
}

/* ===========================
   TOPBAR_LIGHTNING_ANIMATION
   =========================== */

   .topbar{
  position: relative;
  overflow: hidden;
  border-radius: 18px;
  padding: 10px 14px;

  display:flex;
  align-items:center;
  justify-content:space-between;
  margin-bottom:16px;

  background: linear-gradient(120deg, #021b2f, #043c63, #021b2f);
  background-size: 300% 300%;
  animation: topbarFlow 8s ease infinite;
}

.topbar::before{
  content:"";
  position:absolute;
  top:0;
  left:-150%;
  width:60%;
  height:100%;
  background: linear-gradient(
    120deg,
    transparent,
    rgba(0,255,255,.35),
    rgba(0,120,255,.45),
    transparent
  );
  transform: skewX(-25deg);
  animation: lightningMove 4s linear infinite;
  pointer-events:none;
}

.topbar::after{
  content:"";
  position:absolute;
  inset:0;
  border-radius:18px;
  box-shadow:
    0 0 20px rgba(0,180,255,.35),
    inset 0 0 25px rgba(0,150,255,.25);
  pointer-events:none;
}

.topbar .btn{
  position: relative;
  z-index: 2;
  background: rgba(0,0,0,.55);
  border: 1px solid rgba(0,255,255,.25);
  box-shadow: 0 0 12px rgba(0,200,255,.25);
}

@keyframes topbarFlow{
  0%{ background-position: 0% 50%; }
  50%{ background-position: 100% 50%; }
  100%{ background-position: 0% 50%; }
}

@keyframes lightningMove{
  0%{ left:-150%; }
  100%{ left:150%; }
}
.brand{font-family: 'Ovelion', inherit;font-weight: 400;letter-spacing: .04em;}
.pill{
  display:inline-flex; gap:10px; align-items:center;
  padding:10px 14px; border-radius:14px;
  background:rgba(0,0,0,.35); border:1px solid var(--stroke);
  backdrop-filter:blur(14px);
}
.btn{
  display:inline-flex; align-items:center; justify-content:center;
  gap:10px;
  padding:10px 14px; border-radius:14px;
  color:var(--txt); text-decoration:none; font-weight:800;
  border:1px solid var(--stroke);
  background:rgba(0,0,0,.45);
  font-family: 'Ovelion', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  font-weight: 500;
  letter-spacing: .04em;
}
.btn:hover{ transform:translateY(-1px); }

.topbar .btn{
  position: relative;
  z-index: 2;
  background: rgba(0,0,0,.55);
  border: 1px solid rgba(0,255,255,.25);
  box-shadow: 0 0 12px rgba(0,200,255,.25);
}
.card{
  background:var(--card);
  border:1px solid var(--stroke);
  border-radius:20px;
  box-shadow:0 18px 50px rgba(92, 92, 92, 0.35), inset 0 1px 0 rgba(255, 255, 255, 0.801);
  backdrop-filter:blur(18px);
  overflow:hidden;
  min-height: 0;
  height: 100%;
  display: flex;
  flex-direction: column;
}
/* ✅ Allow inner card scroll on detail pages */
.card{ min-height:0; }        /* already ok but keep */
.content{
  flex: 1;
  min-height: 0;
  overflow-y: auto;
  overflow-x: hidden;
}
/* ===== MENU CARD (Vertical Shine) ===== */
.card.side{
  position: relative;
  overflow: hidden;
  border-radius: 22px;

  background: linear-gradient(
    160deg,
    rgba(10,35,60,.9),
    rgba(0,18,35,.95)
  );

  border: 1px solid rgba(0,180,255,.25);
  box-shadow:
    0 0 25px rgba(0,180,255,.25),
    inset 0 0 30px rgba(0,150,255,.08);
}

/* vertical light sweep */
.card.side::before{
  content:"";
  position:absolute;
  top:-120%;
  left:0;
  width:100%;
  height:60%;

  background: linear-gradient(
    to bottom,
    transparent,
    rgba(0,255,255,.35),
    rgba(0,120,255,.45),
    transparent
  );

  animation: menuShineDown 3.5s linear infinite;
  pointer-events:none;
}

/* animation top → bottom */
@keyframes menuShineDown{
  0%{ top:-120%; }
  100%{ top:120%; }
}

.card.side::after{
  content:"";
  position:absolute;
  inset:0;
  border-radius:20px;
  box-shadow:
    0 0 18px rgba(0,180,255,.18),
    inset 0 0 26px rgba(0,150,255,.12);
  pointer-events:none;
}

.card.side .card-h,
.card.side .menu-item{
  position: relative;
  z-index: 2;
}

@keyframes menuFlow{
  0%{ background-position: 0% 50%; }
  50%{ background-position: 100% 50%; }
  100%{ background-position: 0% 50%; }
}

@keyframes menuLightningMove{
  0%{ left:-160%; }
  100%{ left:160%; }
}

/* ✅ IMPORTANT: allow scroll inside form pages too */
/* ✅ IMPORTANT: allow scroll inside form pages too (ONLY direct page form, not table forms) */
.card > form{
  display:flex;
  flex-direction:column;
  min-height:0;
  height:100%;
}
.card > form > .content{
  flex:1;
  min-height:0;
  overflow-y:auto;
}
.card-h{
  padding:16px 18px;
  display:flex; align-items:center; justify-content:space-between;
  border-bottom:1px solid rgba(255, 255, 255, 0.856);
}
.h1{
  font-family: 'Ovelion', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  font-weight: 600;
  font-size: 18px;
  letter-spacing: .04em;
}
.muted{ color:var(--muted); font-size:14px; }

.grid{
  display:grid;
  gap: 12px;
  height: 100%;
  align-items: stretch;
}
@media(min-width:900px){
  .grid{ grid-template-columns: 300px 1fr; }
}

.dot{
  width:10px; height:10px; border-radius:999px;
  background:rgba(34,197,94,.9);
  box-shadow:0 0 16px rgba(34,197,94,.55);
}

/* ===== Menu items ===== */
.menu-item{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;

  padding:12px 14px; border-radius:14px;
  text-decoration:none; color:var(--txt);
  border:1px solid rgba(255,255,255,.08);
  background:rgba(0,0,0,.22);
  margin:10px 12px;

  font-family: 'Ovelion', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  font-weight: 400;
  letter-spacing: .02em;
  -webkit-font-smoothing: antialiased;
  text-rendering: optimizeLegibility;
}
.menu-left{ display:flex; align-items:center; gap:12px; }
.menu-icon{ width:22px; height:22px; object-fit:contain; flex:0 0 22px; }
.menu-text{ font-weight:800; }
.menu-arrow{ opacity:.75; }

.menu-item:hover{
  box-shadow:
    0 0 0 2px rgba(0, 0, 0, 0.623),
    0 8px 22px rgba(0,0,0,.32),
    inset 0 1px 0 rgba(255,255,255,.18);
  border-color:rgba(34,197,94,.26);
}
.menu-item.active{
  border-color: rgba(255,255,255,.28);
  background: linear-gradient(135deg, rgb(255, 255, 255), rgba(5, 166, 241, 0.349));
  box-shadow:
    0 0 0 2px rgba(0, 0, 0, 0.623),
    0 0 22px rgba(0, 0, 0, 0.384),
    inset 0 1px 0 rgba(255,255,255,.22);
  color:#0b2430;
}
.menu-item.active .menu-arrow,
.menu-item.active .menu-text{ color:#0b2430; }

.menu-item:active{
  background: rgba(255,255,255,.85);
  color: #0b2430;
  border-color: rgba(12, 11, 11, 0.65);
  box-shadow:
    inset 0 2px 6px rgba(0,0,0,.22),
    0 0 0 1px rgba(255,255,255,.35);
  transform: translateY(1px);
}
.menu-item:active .menu-arrow{ opacity:.8; }

/* ===== Main scroll area inside card ===== */
.content{
  padding:14px;
  flex: 1;
  min-height: 0;
  overflow-y: auto;
  overflow-x: hidden;
  padding-bottom: 90px;   /* ✅ ចុងក្រោយមិនបាត់ */
  scroll-padding-bottom: 90px;
}
/* ✅ Staff dashboard only: space on top 15px */
.content.staffdash{
  padding-top: 15px;
}
/* ✅ Professional scrollbar spacing */
.content{
  scrollbar-gutter: stable both-edges; /* Chrome/Edge */
  padding-right: 18px;                /* space for scrollbar */
}
.content{
  overscroll-behavior: contain;
  -webkit-overflow-scrolling: touch;
}
/* Chrome/Edge scrollbar */
.content::-webkit-scrollbar{ width: 10px; }
.content::-webkit-scrollbar-track{
  background: rgba(0,0,0,.15);
  border-radius: 999px;
}
.content::-webkit-scrollbar-thumb{
  background: rgba(255,255,255,.28);
  border-radius: 999px;
}
.content::-webkit-scrollbar-thumb:hover{
  background: rgba(255,255,255,.38);
}
/* ===== Table baseline (works for staff pages) ===== */
table{ width:100%; border-collapse:collapse; table-layout: fixed; }
thead tr{ border-bottom: 1px solid rgba(255, 255, 255, 0.911); }
tbody tr{ border-bottom: 1px solid rgba(255, 255, 255, 0.911); }
th,td{
  padding:10px 10px;
  border-bottom: 0;
  font-weight: 400;
  letter-spacing: .02em;
}
td{ color: rgba(255,255,255,.96); }
th{ text-align:left; font-size:12px; letter-spacing:.06em; text-transform:uppercase; color:rgba(255,255,255,.90); }

input,select{
  width:100%; box-sizing:border-box;
  padding:10px 12px; border-radius:12px;
  border:1px solid rgba(255,255,255,.12);
  background:rgba(0, 0, 0, 0.829);
  color:var(--txt);
  outline:none;
}

.row-actions{ display:flex; gap:8px; }

.savebtn{
  padding: 14px 16px;
  min-width: 74px;
  border-radius:12px;
  font-size: 13px;
  border:1px solid rgba(255,255,255,.22);
  background: linear-gradient(135deg, rgba(18, 122, 170, 0.89), rgba(0, 0, 0, 0.911));
  box-shadow:
    0 0 0 1px rgba(255,255,255,.12),
    0 0 22px rgba(34,197,94,.14),
    inset 0 1px 0 rgba(26, 25, 25, 0.22);
  color:var(--txt);
  cursor:pointer;
  font-family: 'Ovelion', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  font-weight: 600;
  letter-spacing: .04em;
}
.savebtn:active{
  background: rgba(255,255,255,.85);
  color: #0b2430;
  box-shadow:
    inset 0 2px 6px rgba(0,0,0,.25),
    0 0 0 1px rgba(255,255,255,.6);
  transform: translateY(1px);
}
.savebtn:focus{
  outline: none;
  background: rgba(255,255,255,.78);
  color: #0b2430;
}

.pager{ display:flex; gap:10px; align-items:center; justify-content:flex-end; padding:12px 14px; }
.pager a{ color:var(--txt); text-decoration:none; font-weight:800; opacity:.85; }
.pager a:hover{ opacity:1; }

/* ===== Status select styling ===== */
.status-select{ background: rgba(0,0,0,.35); color:#fff; font-weight:600; border: 1px solid rgba(255,255,255,.18); }
.status-select option.status-active{ background-color:#22c55e; color:#fff; }
.status-select option.status-danger{ background-color:#ef4444; color:#fff; }
.status-select:has(option:checked.status-danger){
  background:#FF2C2C;
  border-color:#FF2C2C;
  color:#fff;
  box-shadow: 0 0 0 2px rgba(255,44,44,.95), inset 0 1px 0 rgba(255,255,255,.25);
}
.status-select:has(option:checked.status-active){
  border-color: rgba(34,197,94,.7);
  box-shadow: 0 0 0 1px rgba(34,197,94,.35);
}
.inline-form{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap: nowrap;
    }
    .inline-form select{
      width:auto !important;
      min-width: 180px;
      flex: 1 1 auto;
    }
    .inline-form .savebtn{
      flex: 0 0 auto;
      white-space: nowrap;
    }
/* ===== Staff dashboard colorful cards (paste into staff_base.html <style> ) ===== */
  /* ===== Staff dashboard layout (4 cards row) ===== */
.stats-grid{
  display:grid;
  gap:14px;
  grid-template-columns: repeat(4, minmax(0, 1fr));
}

/* Tablet: 2 per row */
@media (max-width: 1100px){
  .stats-grid{ grid-template-columns: repeat(2, 1fr); }
}
/* Mobile: 1 per row */
@media (max-width: 560px){
  .stats-grid{ grid-template-columns: 1fr; }
}

/* ===== Performance card aligns with Loan Applications right edge ===== */
/* ===== Performance row: 2 cards (LEFT perf, RIGHT user mini) ===== */
.perf-wrap{
  margin-top:14px;
  display:grid;
  grid-template-columns: 1fr 1fr;   /* 2 cards side-by-side */
  gap:14px;
  align-items: stretch;
}

/* LEFT card */
.perf-wrap .perf-card{
  min-height: 360px;
  height: auto;
}

/* RIGHT card */
.perf-wrap .user-mini-card{
  min-height: 360px;
  height: auto;

  border-radius: 22px;
  padding: 16px;

  /* paper / glass */
  background: rgba(255,255,255,.12);
  border: 1px solid rgba(255,255,255,.18);
  box-shadow:
    0 18px 50px rgba(0,0,0,.35),
    inset 0 1px 0 rgba(255,255,255,.45);
  backdrop-filter: blur(14px);
  -webkit-backdrop-filter: blur(14px);
}

/* inside text */
.user-mini-phone{
  color: rgba(255,255,255,.96);
  font-weight: 950;
}

/* rows */
.user-mini-body .mini-row{
  display:flex;
  justify-content:space-between;
  padding: 10px 0;
  border-bottom: 1px solid rgba(255,255,255,.10);
}
.user-mini-body .mini-row span{ opacity:.75; }
.user-mini-body .mini-row strong{ font-weight: 950; }

/* Responsive: stack */
@media (max-width: 1100px){
  .perf-wrap{ grid-template-columns: 1fr; }
  .perf-wrap .perf-card,
  .perf-wrap .user-mini-card{
    min-height: 300px;
  }
}

/* Responsive: on tablet/mobile full width */
@media (max-width:1100px){
  .perf-wrap .user-mini-card{
    grid-column: 1 / -1;
    height: auto;
    min-height: 260px;
  }
  .perf-wrap .perf-card{
    height: auto;
    min-height: 360px;
  }
}
.stat-card{
  border-radius:20px;
  padding:16px 16px 14px;
  border:1px solid rgba(255,255,255,.14);
  box-shadow:0 18px 50px rgba(0,0,0,.28), inset 0 1px 0 rgba(255,255,255,.35);
  color:#fff;
  position:relative;
  overflow:hidden;
}

.stat-card::before{
  content:"";
  position:absolute;
  inset:0;
  background: radial-gradient(900px 240px at 10% 10%, rgba(255,255,255,.22), transparent 55%);
  pointer-events:none;
}

.stat-top{
  display:flex;
  align-items:flex-start;
  justify-content:space-between;
  gap:10px;
}

.stat-title{ font-weight:950; font-size:14px; letter-spacing:.02em; }
.stat-sub{ font-size:11px; opacity:.85; margin-top:2px; }

.stat-ico{
  width:34px; height:34px;
  border-radius:12px;
  background: rgba(0,0,0,.18);
  border:1px solid rgba(255,255,255,.18);
  display:flex; align-items:center; justify-content:center;
  font-size:16px;
}

.stat-num{
  font-size:34px;
  font-weight:950;
  margin-top:10px;
  letter-spacing:.02em;
}

.stat-btn{
  margin-top:12px;
  display:inline-flex;
  align-items:center;
  justify-content:center;
  padding:10px 14px;
  border-radius:14px;
  text-decoration:none;
  font-weight:900;
  color:#fff;
  border:1px solid rgba(255,255,255,.18);
  background: rgba(0,0,0,.18);
}
.stat-btn:hover{ transform: translateY(-1px); }
.stat-btn:active{ transform: translateY(0); opacity:.92; }

/* Color themes */
.stat-teal{
  background: linear-gradient(135deg, rgba(16,185,129,.85), rgba(2,132,199,.75));
}
.stat-orange{
  background: linear-gradient(135deg, rgba(249,115,22,.9), rgba(245,158,11,.75));
}
.stat-purple{
  background: linear-gradient(135deg, rgba(168,85,247,.9), rgba(236,72,153,.75));
}
/* ===== Payment Method Bright Glass ===== */
.stat-dark{
  background: linear-gradient(
    135deg,
    rgba(255,255,255,.75),
    rgba(220,230,240,.65)
  );

  border: 1px solid rgba(255,255,255,.6);

  box-shadow:
    0 0 25px rgba(255,255,255,.35),
    inset 0 1px 0 rgba(255,255,255,.9);

  color:#0b2430;
}

/* fix text color inside */
.stat-dark .stat-title,
.stat-dark .stat-num{
  color:#0b2430;
}
/* ===== Stat card icon (webp) ===== */
.stat-ico{
  width: 34px;
  height: 34px;
  border-radius: 10px;
  display:flex;
  align-items:center;
  justify-content:center;
  background: rgba(255,255,255,.18);
  border: 1px solid rgba(255,255,255,.22);
  box-shadow: inset 0 1px 0 rgba(255,255,255,.25);
}
.stat-ico img{
  width: 18px;
  height: 18px;
  object-fit: contain;
  display:block;
  filter: drop-shadow(0 2px 6px rgba(0,0,0,.25));
}

/* ===== Performance Overview card ===== */
.perf-card{
  border-radius: 22px;
  border: 1px solid rgba(255,255,255,.12);
  background: rgba(0,0,0,.30);
  box-shadow: 0 18px 50px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.18);
  padding: 16px;
}

.perf-head{
  display:flex;
  align-items:flex-start;
  justify-content:space-between;
  gap:12px;
  margin-bottom: 12px;
}
.perf-title{
  font-size:18px;
  font-weight:900;
  color:#fff;
}
.perf-sub{
  font-size:12px;
  opacity:.75;
  color:#eafff1;
  margin-top:4px;
}

.perf-bars{
  display:flex;
  align-items:flex-end;
  justify-content:space-between;
  gap: 18px;                 /* ✅ space រវាង bar */
  min-height: 300px;

  padding: 10px 22px 60px;   /* ✅ បន្ថែម padding ស្ដាំ/ឆ្វេង + ខាងក្រោម */
  box-sizing: border-box;

  border-radius:18px;
  background: rgba(255,255,255,.06);
  border:1px solid rgba(255,255,255,.10);

  overflow: hidden;          /* ✅ កុំឲ្យអ្វីលានក្រៅ card */
}

.bar{
  width:28px;              /* ស្គម */
  border-radius:12px;
  display:flex;
  align-items:flex-end;
  justify-content:center;
  position:relative;
  box-shadow: inset 0 1px 0 rgba(255,255,255,.25);
  flex: 1 1 0;
  min-width: 0;
}
.bar span{
  position:absolute;
  bottom: -32px;           /* ✅ ចុះក្រោមបន្តិច */
  left: 50%;
  transform: translateX(-50%);
  font-size: 14px;         /* ✅ ធំឡើង (ប្រហែល +3px) */
  font-weight: 900;
  opacity: .90;
  color:#eafff1;
  white-space: nowrap;
  padding: 0 6px;
  max-width: 100%;
  text-align: center;
}

.bar i{
  position:absolute;
  top: 10px;
  font-style: normal;
  font-size: 12px;
  font-weight: 950;
  color: rgba(255,255,255,.95);
  text-shadow: 0 6px 20px rgba(0,0,0,.35);
}

.bar.teal{ background: linear-gradient(180deg, rgba(0,255,204,.95), rgba(0,110,120,.75)); }
.bar.orange{ background: linear-gradient(180deg, rgba(255,140,60,.95), rgba(160,70,10,.75)); }
.bar.purple{ background: linear-gradient(180deg, rgba(255,60,200,.95), rgba(120,40,140,.75)); }

@media (max-width: 980px){
  .perf-bars{ grid-template-columns: repeat(3, 1fr); height: 220px; }
}
/* ===== Perf animations ===== */
.perf-bars .bar{
  transform-origin: bottom;
  animation: barGrow 900ms cubic-bezier(.2,.9,.2,1) both;
}

.perf-bars .bar:nth-child(1){ animation-delay: 80ms; }
.perf-bars .bar:nth-child(2){ animation-delay: 160ms; }
.perf-bars .bar:nth-child(3){ animation-delay: 240ms; }
.perf-bars .bar:nth-child(4){ animation-delay: 320ms; }
.perf-bars .bar:nth-child(5){ animation-delay: 400ms; }
.perf-bars .bar:nth-child(6){ animation-delay: 480ms; }

@keyframes barGrow{
  from{ transform: scaleY(0.12); filter: saturate(.9); opacity: .75; }
  to  { transform: scaleY(1);    filter: saturate(1);  opacity: 1; }
}
/* ===== Dashboard Search ===== */
.dash-search{
  display:flex;
  align-items:center;
  gap:10px;
}
.dash-select{
  height:42px;
  padding:0 12px;
  border-radius:12px;
  border:1px solid rgba(255,255,255,.18);
  background:rgba(0,0,0,.38);
  color:#fff;
  min-width:150px;
}
.dash-input{
  height:42px;
  width:240px;
  padding:0 14px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.18);
  background:rgba(0,0,0,.40);
  color:#fff;
}
.dash-btn{
  height:42px;
  padding:0 18px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.18);
  background:linear-gradient(135deg,#127aaa,#000);
  color:#fff;
  font-weight:900;
  cursor:pointer;
}
/* ===== Dashboard Overview Glass Effect ===== */
.dashboard-card{
  background: rgba(0, 0, 0, 0.2) !important;   /* កាត់ភាពខ្មៅ */
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255,255,255,.08);
  box-shadow:
    0 20px 60px rgba(0,0,0,.35),
    inset 0 1px 0 rgba(255,255,255,.15);
}
/* ===== Bright White Titles ===== */
.brand,
.h1{
  color: #ffffff !important;
  font-weight: 800;
  letter-spacing: .04em;

  text-shadow:
    0 0 6px rgba(255,255,255,.6),
    0 0 14px rgba(0,200,255,.35);
}

/* Optional – Make subtitle slightly brighter too */
.muted{
  color: rgba(255,255,255,.88);
}
/* ===== Neon White Glow Titles ===== */

/* Topbar buttons */
.topbar .btn{
  color:#ffffff !important;
  font-weight:800;
  text-shadow:
    0 0 6px rgba(255,255,255,.7),
    0 0 14px rgba(0,200,255,.45);
}

/* Performance Overview title */
.perf-title{
  color:#ffffff !important;
  font-weight:900;
  text-shadow:
    0 0 6px rgba(255,255,255,.7),
    0 0 14px rgba(0,200,255,.45);
}

/* Optional – make subtitle slightly glow too */
.perf-sub{
  color:rgba(255,255,255,.9);
}

/* ===== User Mini Detail Card ===== */
.user-mini-card{
  border-radius:22px;
  border:1px solid rgba(255,255,255,.12);
  background: rgba(0,0,0,.45);
  box-shadow: 0 18px 50px rgba(0,0,0,.45),
              inset 0 1px 0 rgba(255,255,255,.15);
  padding:18px;
  min-height:260px;
  display:flex;
  flex-direction:column;
  justify-content:space-between;
  animation: fadeInUser 400ms ease;
}

@keyframes fadeInUser{
  from{opacity:0; transform:translateY(20px);}
  to{opacity:1; transform:translateY(0);}
}

.user-mini-head{
  display:flex;
  align-items:center;
  gap:14px;
  margin-bottom:14px;
}

.user-mini-icon{
  width:52px;
  height:52px;
  border-radius:16px;
  background:rgba(255,255,255,.15);
  display:flex;
  align-items:center;
  justify-content:center;
}

.user-mini-icon img{
  width:28px;
  height:28px;
}

.user-mini-phone{
  font-size:18px;
  font-weight:900;
  color:#fff;
  text-shadow:0 0 10px rgba(0,200,255,.4);
}

.user-mini-body{
  display:flex;
  flex-direction:column;
  gap:12px;
}

.mini-row{
  display:flex;
  justify-content:space-between;
  font-size:14px;
  color:rgba(255,255,255,.85);
}

.mini-row strong{
  color:#ffffff;
  font-weight:900;
}
/* ===== User mini card (right side) ===== */
.perf-wrap .user-mini-card{
  grid-column: 3 / span 2;     /* ឲ្យទៅខាងស្តាំ 2 columns */
  min-height: 360px;
  border-radius: 22px;
  border: 1px solid rgba(255,255,255,.12);
  background: rgba(0,0,0,.30);
  box-shadow: 0 18px 50px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.18);
  padding: 16px;
}

@media (max-width:1100px){
  .perf-wrap .user-mini-card{ grid-column: 1 / -1; } /* Tablet/mobile => xuốngក្រោម */
}

.user-mini-head{
  display:flex;
  align-items:center;
  gap:12px;
  margin-bottom: 14px;
}
.user-mini-icon{
  width:42px;height:42px;
  border-radius:14px;
  display:flex;align-items:center;justify-content:center;
  background: rgba(255,255,255,.10);
  border: 1px solid rgba(255,255,255,.14);
}
.user-mini-icon img{ width:20px;height:20px; }
.user-mini-phone{
  font-weight: 950;
  color: rgba(255,255,255,.95);
}
.user-mini-body .mini-row{
  display:flex;
  justify-content:space-between;
  padding: 10px 0;
  border-bottom: 1px solid rgba(255,255,255,.08);
}
.user-mini-body .mini-row span{ opacity:.75; }
.user-mini-body .mini-row strong{ color: rgba(255,255,255,.95); }

/* Make phone links white (tables/pages) */
table a{
  color: rgba(255,255,255,.95) !important;
  text-decoration: none;
}
table a:hover{
  text-decoration: underline;
}
/* ===== WELCOME ANIMATION: play ONCE per session ===== */
body.no-welcome-anim .pill.pill-anim-top,
body.no-welcome-anim .card.card-anim,
body.no-welcome-anim .card.card-anim-left{
  animation: none !important;
}
.period-buttons{
  display:flex;
  gap:12px;
  flex-wrap:wrap;
}

.period-btn{
  padding:10px 22px;
  min-height:42px;

  border-radius:8px;              /* ⬅ មិនមូលទៀត */
  border:1px solid rgba(255,255,255,.18);

  background:rgba(255,255,255,.06);
  color:#fff;

  font-size:14px;                  /* ⬅ ធំជាងមុន */
  font-weight:800;
  letter-spacing:.3px;

  cursor:pointer;
  transition:all .2s ease;
}

.period-btn:hover{
  background:rgba(255,255,255,.14);
  transform:translateY(-1px);
}

.period-btn.active{
  background:linear-gradient(90deg,#004182,#0a6ad6);
  border:1px solid #0a6ad6;
  box-shadow:0 6px 18px rgba(0,0,0,.45);
}
body, body *{
  font-family: 'Ovelion', sans-serif !important;
}
/* ===== Staff responsive fix (PHONE) ===== */

/* allow page scroll on phone (important) */
body{
  overflow: auto !important;
  height: auto !important;
  min-height: 100vh;
}

/* wrap height flexible on phone */
.wrap{
  height: auto !important;
  min-height: calc(100vh - 20px);
}

/* topbar not overlap */
.topbar{
  flex-wrap: wrap;
  gap: 10px;
}
.pill{
  flex-wrap: wrap;
}

/* grid: stack menu + content on phone */
@media (max-width: 900px){
  .grid{
    grid-template-columns: 1fr !important;   /* 1 column */
    height: auto !important;
  }

  .card{
    height: auto !important;                /* don't force full height */
    min-height: 0;
  }

  .content{
    padding-bottom: 40px;                   /* prevent bottom cut */
    overflow: visible;                      /* allow normal flow */
  }

  /* table/forms avoid squeeze */
  table{ table-layout: auto !important; }
  input, select, textarea{ width: 100% !important; }
}

/* very small phones */
@media (max-width: 560px){
  .dash-search{ flex-wrap: wrap; }
  .dash-input{ width: 100% !important; }
  .dash-select{ width: 100% !important; }
  .dash-btn{ width: 100% !important; }
}

/* ✅ FIX: allow scroll anywhere (whole page) */
html, body{
  height: auto !important;
}

body{
  overflow-y: auto !important;
  overflow-x: hidden !important;
}

/* remove forced full-screen height */
.wrap{
  height: auto !important;
  min-height: calc(100vh - 20px) !important;
}

.grid{
  height: auto !important;
}

.card{
  height: auto !important;
}

/* stop inner-scroll taking over wheel */
.content{
  overflow: visible !important;
}

  </style>
</head>

<body>
  <div class="wrap">
    <div class="topbar">
      <div class="pill pill-anim-top">
        <div class="brand">Login By</div>
        <div class="muted">({{ request.user.phone }})</div>
      </div>
      <div class="pill pill-anim-top">
        <a class="btn" href="{% url 'staff_dashboard' %}">Dashboard</a>
        <a class="btn" href="#" id="staffLogoutBtn">Logout</a>
      </div>
    </div>

    <div class="grid">
      <!-- LEFT MENU -->
      <div class="card side card-anim-left">
        <div class="card-h">
          <div class="h1">Menu</div>
          <span class="dot"></span>
        </div>

        <a href="{% url 'staff_users' %}"
           class="menu-item {% if request.resolver_match.url_name == 'staff_users' %}active{% endif %}">
          <span class="menu-left">
            <img src="{% static 'icons/users.png' %}" class="menu-icon" alt="">
            <span class="menu-text">Users</span>
          </span>
          <span class="menu-arrow">→</span>
        </a>

        <a href="{% url 'staff_loans' %}"
           class="menu-item {% if request.resolver_match.url_name == 'staff_loans' %}active{% endif %}">
          <span class="menu-left">
            <img src="{% static 'icons/loans.png' %}" class="menu-icon" alt="">
            <span class="menu-text">Loans</span>
          </span>
          <span class="menu-arrow">→</span>
        </a>

        <a href="{% url 'staff_withdrawals' %}"
           class="menu-item {% if request.resolver_match.url_name == 'staff_withdrawals' %}active{% endif %}">
          <span class="menu-left">
            <img src="{% static 'icons/withdrawals.png' %}" class="menu-icon" alt="">
            <span class="menu-text">Withdrawals</span>
          </span>
          <span class="menu-arrow">→</span>
        </a>

        <a href="{% url 'staff_payment_methods' %}"
           class="menu-item {% if request.resolver_match.url_name == 'staff_payment_methods' %}active{% endif %}">
          <span class="menu-left">
            <img src="{% static 'icons/payments.png' %}" class="menu-icon" alt="">
            <span class="menu-text">Payment Methods</span>
          </span>
          <span class="menu-arrow">→</span>
        </a>
      </div>

      <!-- RIGHT CONTENT -->
      <div class="card card-anim dashboard-card">
        {% block content %}{% endblock %}
      </div>
    </div>
  </div>

  <!-- ✅ ONE Message Modal (shared for ALL staff pages) -->
  <div id="msgModal" aria-hidden="true">
    <div class="modal-box" role="dialog" aria-modal="true" aria-label="Edit Message">
      <h3 id="msgTitle">Edit message</h3>
      <textarea id="msgTextarea" placeholder="Type message here..."></textarea>
      <div class="modal-actions">
        <button type="button" class="btn" onclick="applyMsg()">OK</button>
        <button type="button" class="btn" onclick="closeMsgModal()">Cancel</button>
      </div>
    </div>
  </div>

  <!-- ✅ Staff Logout Confirm Modal -->
  <div id="staffLogoutModal" class="logout-modal" aria-hidden="true">
    <div class="logout-box" role="dialog" aria-modal="true" aria-label="Confirm Logout">
      <div class="logout-title">Confirm Logout</div>
      <div class="logout-text">Are you sure you want to logout?</div>

      <div class="logout-actions">
        <button type="button" class="btn-cancel" id="staffLogoutCancel">Cancel</button>

        <form method="post" action="{% url 'staff_logout' %}" style="margin:0;">
          {% csrf_token %}
          <button type="submit" class="btn-confirm">Logout</button>
        </form>
      </div>
    </div>
  </div>

  <!-- ✅ Scripts MUST be inside body -->
  <script>
    // ============ Staff Logout Modal ============
    (function(){
      const btn = document.getElementById("staffLogoutBtn");
      const modal = document.getElementById("staffLogoutModal");
      const cancel = document.getElementById("staffLogoutCancel");
      if(!btn || !modal) return;

      function openModal(e){
        if(e) e.preventDefault();
        modal.classList.add("show");
        modal.setAttribute("aria-hidden","false");
      }
      function closeModal(){
        modal.classList.remove("show");
        modal.setAttribute("aria-hidden","true");
      }

      btn.addEventListener("click", openModal);
      if(cancel) cancel.addEventListener("click", closeModal);

      modal.addEventListener("click", (e) => { if(e.target === modal) closeModal(); });
      document.addEventListener("keydown", (e) => { if(e.key === "Escape") closeModal(); });
    })();

    // ============ Message Modal (shared) ============
    window.__msgModalInput = window.__msgModalInput || null;

    function openMsgModal(input){
      window.__msgModalInput = input;

      const modal = document.getElementById("msgModal");
      const textarea = document.getElementById("msgTextarea");
      const title = document.getElementById("msgTitle");

      textarea.value = input.value || "";
      title.textContent = (input.dataset.type === "alert")
        ? "Edit ALERT message"
        : "Edit CONGRATULATION message";

      modal.style.display = "flex";
      modal.setAttribute("aria-hidden","false");
      textarea.focus();
    }

    function closeMsgModal(){
      const modal = document.getElementById("msgModal");
      modal.style.display = "none";
      modal.setAttribute("aria-hidden","true");
      window.__msgModalInput = null;
    }

    function applyMsg(){
      if(!window.__msgModalInput) return;
      const textarea = document.getElementById("msgTextarea");
      window.__msgModalInput.value = textarea.value;
      closeMsgModal();
    }
  </script>
  <script>
    // ===== Perf counter animation (count-up) =====
    (function(){
      function animateCount(el, to, duration){
        to = Number(to || 0);
        if(!Number.isFinite(to)) to = 0;
  
        const t0 = performance.now();
  
        function tick(t){
          const p = Math.min(1, (t - t0) / duration);
          const eased = 1 - Math.pow(1 - p, 3); // easeOutCubic
          const val = Math.round(to * eased);
          el.textContent = val;
  
          if(p < 1) requestAnimationFrame(tick);
        }
        requestAnimationFrame(tick);
      }
  
      function runPerfCounters(){
        const counters = document.querySelectorAll(".perf-card .count[data-value]");
        counters.forEach((el) => {
          const target = el.getAttribute("data-value");
          el.textContent = "0";
          animateCount(el, target, 900);
        });
      }
  
      window.addEventListener("load", () => {
        setTimeout(runPerfCounters, 250);
      });
    })();
  </script>
  <script>
    (function(){
      // if already played in this tab/session, disable animations
      if (sessionStorage.getItem("staffWelcomePlayed") === "1"){
        document.body.classList.add("no-welcome-anim");
        return;
      }
      // first time: allow animations, then mark as played
      sessionStorage.setItem("staffWelcomePlayed", "1");
    })();
    
  </script>
</body>
</html>