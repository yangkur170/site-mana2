{% extends "staff_base.html" %}
{% block title %}Staff - Payment Methods{% endblock %}
{% block content %}
  <div class="card-h">
    <div>
      <div class="h1">Payment Methods</div>
      <div class="muted">Edit wallet/bank/paypal + lock</div>
    </div>
    <form method="get" style="display:flex;gap:10px;align-items:center;">
      <input name="q" value="{{ q }}" placeholder="Search phone..." style="width:260px;">
      <button class="savebtn" type="submit">Search</button>
    </form>
  </div>

  <div class="content" style="overflow:auto;">
    <table>
      <thead>
        <tr>
          <th>User</th>
          <th>Wallet</th>
          <th>Bank</th>
          <th>PayPal</th>
          <th>Locked</th>
          <th>Save</th>
        </tr>
      </thead>
      <tbody>
        {% for pm in page.object_list %}
        <tr>
          <form method="post" action="{% url 'staff_payment_method_update' pm.id %}">
            {% csrf_token %}
            <td class="user-font">{{ pm.user.phone }}</td>
            <td>
              <input name="wallet_name" value="{{ pm.wallet_name }}">
              <div style="height:8px"></div>
              <input name="wallet_phone" value="{{ pm.wallet_phone }}">
            </td>
            <td>
              <input name="bank_name" value="{{ pm.bank_name }}">
              <div style="height:8px"></div>
              <input name="bank_account" value="{{ pm.bank_account }}">
            </td>
            <td><input name="paypal_email" value="{{ pm.paypal_email }}"></td>
            <td>
              <select name="locked">
                <option value="False" {% if not pm.locked %}selected{% endif %}>Off</option>
                <option value="True"  {% if pm.locked %}selected{% endif %}>On</option>
              </select>
            </td>
            <td><button class="savebtn" type="submit">Save</button></td>
          </form>
        </tr>
        {% empty %}
        <tr><td colspan="6" class="muted">No payment methods</td></tr>
        {% endfor %}
      </tbody>
    </table>

    <div class="pager">
      {% if page.has_previous %}
        <a href="?q={{ q }}&page={{ page.previous_page_number }}">← Prev</a>
      {% endif %}
      <span class="muted">Page {{ page.number }} / {{ page.paginator.num_pages }}</span>
      {% if page.has_next %}
        <a href="?q={{ q }}&page={{ page.next_page_number }}">Next →</a>
      {% endif %}
    </div>
  </div>
{% endblock %}